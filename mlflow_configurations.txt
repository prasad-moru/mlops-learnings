# Update system packages
sudo apt update && sudo apt upgrade -y

# Install Python and essential tools
sudo apt install -y python3 python3-pip python3-venv git build-essential

# Install additional dependencies
sudo apt install -y libpq-dev python3-dev



# Create project directory
mkdir ~/mlflow-server
cd ~/mlflow-server

# Create and activate virtual environment
python3 -m venv mlflow-env
source mlflow-env/bin/activate


# Install MLflow (basic installation)
pip install mlflow

# Or install with additional dependencies
pip install mlflow[extras]  # Includes scikit-learn, boto3, etc.

# Verify installation
mlflow --version


# Start MLflow tracking server (simplest setup)
mlflow ui

# Access at: http://localhost:5000




# Install PostgreSQL
sudo apt install -y postgresql postgresql-contrib

# Start PostgreSQL service
sudo systemctl start postgresql
sudo systemctl enable postgresql

# Create database and user
sudo -u postgres psql

# In PostgreSQL prompt:
CREATE DATABASE mlflow_db;
CREATE USER mlflow_user WITH PASSWORD 'your_password';
GRANT ALL PRIVILEGES ON DATABASE mlflow_db TO mlflow_user;
\q




# Install PostgreSQL Python driver
pip install psycopg2-binary

# Start MLflow server with PostgreSQL backend
mlflow server \
    --backend-store-uri postgresql://mlflow_user:your_password@localhost/mlflow_db \
    --default-artifact-root ~/mlflow/artifacts \
    --host 0.0.0.0 \
    --port 5000




-- Connect to the mlflow database
\c mlflow_db

-- Grant schema permissions
GRANT ALL ON SCHEMA public TO mlflow_user;
GRANT ALL PRIVILEGES ON ALL TABLES IN SCHEMA public TO mlflow_user;
GRANT ALL PRIVILEGES ON ALL SEQUENCES IN SCHEMA public TO mlflow_user;

-- Grant future permissions
ALTER DEFAULT PRIVILEGES IN SCHEMA public GRANT ALL ON TABLES TO mlflow_user;
ALTER DEFAULT PRIVILEGES IN SCHEMA public GRANT ALL ON SEQUENCES TO mlflow_user;

-- Make mlflow_user owner of the database (alternative approach)
ALTER DATABASE mlflow_db OWNER TO mlflow_user;

-- Exit PostgreSQL
\q